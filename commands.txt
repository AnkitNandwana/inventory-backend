# create project root
mkdir inventory-backend && cd inventory-backend

# initialize git
git init

python3 -m venv .venv
# activate it
source .venv/bin/activate

# confirm python points to venv
which python
python -V


1️⃣ Create Django Project + Base Folders
Run inside:

(.venv) ~/projects/personal/inventory-backend$

django-admin startproject config .
mkdir apps
mkdir docs
mkdir worker
mkdir requirements

#Update your requirements.txt OR create modular:
echo "Django>=4.2
strawberry-graphql>=0.130
strawberry-graphql-django>=0.13
psycopg2-binary>=2.9
python-dotenv>=1.0
django-cors-headers>=3.13
google-auth>=2.0
pyjwt>=2.0
celery>=5.2
redis>=4.0" > requirements/base.txt

#cd apps

django-admin startapp auth_app
django-admin startapp product
django-admin startapp supplier
django-admin startapp purchase
django-admin startapp sales
django-admin startapp inventory

cd ..


#setup database

sudo -u postgres psql
# inside psql:
CREATE DATABASE inventory_db;
CREATE USER inventory_user WITH PASSWORD 'inventory_user';
GRANT ALL PRIVILEGES ON DATABASE inventory_db TO inventory_user;
\q

#Run migrations
python3 manage.py makemigrations
python3 manage.py migrate

#github => use below command to set remote url for personal account
git remote set-url origin git@github.com-personal:AnkitNandwana/inventory-backend.git


#Create product models and define schema and migrations

create this to rename tables as it generated wrong name
python manage.py makemigrations product --empty -n rename_tables


 python manage.py makemigrations product
 python manage.py migrate
 python manage.py makemigrations product --empty -n rename_tables
 python manage.py migrate
 python manage.py makemigrations supplier
 python manage.py migrate
 python manage.py makemigrations purchase
 python manage.py migrate
 rm apps/product/migrations/0003_rename_product*
 python manage.py migrate product --fake
 python manage.py migrate
 git gui
 dropdb inventory_db
 createdb inventory_db
 python manage.py migrate
 ls apps/product/migrations
 python manage.py migrate
 python manage.py migrate --fake-initial
 python manage.py migrate product
 python manage.py makemigrations purchase
 python manage.py migrate
 git gui
 dropdb inventory_db
 createdb inventory_db
 python manage.py migrate

#apply and run migrations
python manage.py makemigrations auth_app
python manage.py makemigrations product
python manage.py makemigrations supplier
python manage.py makemigrations purchase
python manage.py makemigrations sales
python manage.py makemigrations inventory

# Then apply all
python manage.py 


#to run server with websocket

start django with websocket =>  daphne config.asgi:application
Start Kafka => docker-compose up broker
Start Consumer => python manage.py start_kafka_consumer