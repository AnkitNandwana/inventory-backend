<!DOCTYPE html>
<html>
<head>
    <title>Purchase Suggestions WebSocket Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .message { 
            background: #f0f0f0; 
            padding: 10px; 
            margin: 5px 0; 
            border-radius: 5px; 
        }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        #status { font-weight: bold; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>Purchase Suggestions WebSocket Test</h1>
    <div id="status">Connecting...</div>
    <div id="messages"></div>

    <script>
        const messagesDiv = document.getElementById('messages');
        const statusDiv = document.getElementById('status');
        
        function addMessage(message, type = 'message') {
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong><br><pre>${JSON.stringify(message, null, 2)}</pre>`;
            messagesDiv.insertBefore(div, messagesDiv.firstChild);
        }

        // Connect to WebSocket
        const ws = new WebSocket('ws://localhost:8000/ws/purchase-suggestions/');
        
        ws.onopen = function(event) {
            statusDiv.textContent = '‚úÖ Connected to Purchase Suggestions WebSocket';
            statusDiv.style.color = 'green';
            addMessage({type: 'connection', message: 'Connected successfully'}, 'success');
        };
        
        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            console.log('WebSocket message received:', data);
            addMessage(data, 'success');
        };
        
        ws.onerror = function(error) {
            statusDiv.textContent = '‚ùå WebSocket Error';
            statusDiv.style.color = 'red';
            addMessage({type: 'error', message: error.toString()}, 'error');
        };
        
        ws.onclose = function(event) {
            statusDiv.textContent = 'üîå WebSocket Disconnected';
            statusDiv.style.color = 'orange';
            addMessage({type: 'disconnect', code: event.code, reason: event.reason}, 'error');
        };
    </script>
</body>
</html>